name: set-product-version
author: Release Engineering <rel-eng@hashicorp.com>
description: Automates setting product version


runs:
  using: composite

  steps:
    - uses: actions/checkout@v3
    - name: Check if Version File Exists
      shell: bash
      env:
        VERSION_FILE: .release/VERSION
      run: |
        if [ -f $VERSION_FILE ]; then
          echo "File ${VERSION_FILE} exists."
        else
          echo "File ${VERSION_FILE} does not exist. Please add a VERSION file in the .release/ directory"
        fi
    - name: Set Product Version
      shell: bash
      run: |
        product_version=$(<.release/VERSION)
        product_version=$(echo "$product_version" | sed 's/ //g')
        echo "Product Version: $product_version"

    - name: Set output
      shell: bash
      run: echo "product-version={product_version}" >> GITHUB_OUTPUT